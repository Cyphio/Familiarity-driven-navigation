Beginning training
C:\Users\harry\anaconda3\envs\ML38\lib\site-packages\torch\nn\modules\module.py:795: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Epoch 01: | Train Loss: 0.64655 | Val Loss: 0.63401 | Train Acc: 65.806 | Val Acc: 66.667
Epoch 02: | Train Loss: 0.64172 | Val Loss: 0.62869 | Train Acc: 66.583 | Val Acc: 66.875
Epoch 03: | Train Loss: 0.63585 | Val Loss: 0.62288 | Train Acc: 66.361 | Val Acc: 66.542
Epoch 04: | Train Loss: 0.62019 | Val Loss: 0.60402 | Train Acc: 66.333 | Val Acc: 66.667
Epoch 05: | Train Loss: 0.59313 | Val Loss: 0.55830 | Train Acc: 66.222 | Val Acc: 66.625
Epoch 06: | Train Loss: 0.52870 | Val Loss: 0.60795 | Train Acc: 70.444 | Val Acc: 66.167
Epoch 07: | Train Loss: 0.43672 | Val Loss: 0.35756 | Train Acc: 78.333 | Val Acc: 81.625
Epoch 08: | Train Loss: 0.42193 | Val Loss: 0.46322 | Train Acc: 80.139 | Val Acc: 77.333
Epoch 09: | Train Loss: 0.39743 | Val Loss: 0.38709 | Train Acc: 80.806 | Val Acc: 78.125
Epoch 10: | Train Loss: 0.35907 | Val Loss: 0.29494 | Train Acc: 82.917 | Val Acc: 88.500
Epoch 11: | Train Loss: 0.36463 | Val Loss: 0.30133 | Train Acc: 82.639 | Val Acc: 88.333
Epoch 12: | Train Loss: 0.33219 | Val Loss: 0.29414 | Train Acc: 85.472 | Val Acc: 85.625
Epoch 13: | Train Loss: 0.29917 | Val Loss: 0.27094 | Train Acc: 86.889 | Val Acc: 90.292
Epoch 14: | Train Loss: 0.31011 | Val Loss: 0.26259 | Train Acc: 86.028 | Val Acc: 89.458
Epoch 15: | Train Loss: 0.27130 | Val Loss: 0.25285 | Train Acc: 89.556 | Val Acc: 89.375
Epoch 16: | Train Loss: 0.28447 | Val Loss: 0.25163 | Train Acc: 87.667 | Val Acc: 89.125
Epoch 17: | Train Loss: 0.33027 | Val Loss: 0.49323 | Train Acc: 85.389 | Val Acc: 75.458
Epoch 18: | Train Loss: 0.35481 | Val Loss: 0.54576 | Train Acc: 83.528 | Val Acc: 71.625
Epoch 19: | Train Loss: 0.31474 | Val Loss: 0.25546 | Train Acc: 85.972 | Val Acc: 89.375
Epoch 20: | Train Loss: 0.26995 | Val Loss: 0.28627 | Train Acc: 88.306 | Val Acc: 88.375
Epoch 21: | Train Loss: 0.24545 | Val Loss: 0.24958 | Train Acc: 89.417 | Val Acc: 89.583
Epoch 22: | Train Loss: 0.29892 | Val Loss: 0.24175 | Train Acc: 87.111 | Val Acc: 90.167
Epoch 23: | Train Loss: 0.25825 | Val Loss: 0.29813 | Train Acc: 88.667 | Val Acc: 85.917
Epoch 24: | Train Loss: 0.25105 | Val Loss: 0.23737 | Train Acc: 89.806 | Val Acc: 90.000
Epoch 25: | Train Loss: 0.23708 | Val Loss: 0.35605 | Train Acc: 89.472 | Val Acc: 82.875
Epoch 26: | Train Loss: 0.27544 | Val Loss: 0.34551 | Train Acc: 87.472 | Val Acc: 84.167
Epoch 27: | Train Loss: 0.27200 | Val Loss: 0.43830 | Train Acc: 88.917 | Val Acc: 81.333
Epoch 28: | Train Loss: 0.24909 | Val Loss: 0.41598 | Train Acc: 89.861 | Val Acc: 82.083
Epoch 29: | Train Loss: 0.31428 | Val Loss: 0.29317 | Train Acc: 86.639 | Val Acc: 85.875
Epoch 30: | Train Loss: 0.23301 | Val Loss: 0.28535 | Train Acc: 89.806 | Val Acc: 87.333
Epoch 31: | Train Loss: 0.23236 | Val Loss: 0.24561 | Train Acc: 89.833 | Val Acc: 89.375
Epoch 32: | Train Loss: 0.21856 | Val Loss: 0.28145 | Train Acc: 90.639 | Val Acc: 87.958
Epoch 33: | Train Loss: 0.23154 | Val Loss: 0.22437 | Train Acc: 90.556 | Val Acc: 90.667
Epoch 34: | Train Loss: 0.23445 | Val Loss: 0.23888 | Train Acc: 90.389 | Val Acc: 89.958
Epoch 35: | Train Loss: 0.26849 | Val Loss: 0.32160 | Train Acc: 88.333 | Val Acc: 84.917
Epoch 36: | Train Loss: 0.21626 | Val Loss: 0.25681 | Train Acc: 91.611 | Val Acc: 89.417
Epoch 37: | Train Loss: 0.22886 | Val Loss: 0.29407 | Train Acc: 90.389 | Val Acc: 86.917
Epoch 38: | Train Loss: 0.28437 | Val Loss: 0.23352 | Train Acc: 87.639 | Val Acc: 90.333
Epoch 39: | Train Loss: 0.21537 | Val Loss: 0.24836 | Train Acc: 91.028 | Val Acc: 90.042
Epoch 40: | Train Loss: 0.23940 | Val Loss: 0.41743 | Train Acc: 90.167 | Val Acc: 80.708
Epoch 41: | Train Loss: 0.23668 | Val Loss: 0.22407 | Train Acc: 89.917 | Val Acc: 91.167
Epoch 42: | Train Loss: 0.19954 | Val Loss: 0.21821 | Train Acc: 92.028 | Val Acc: 91.292
Epoch 43: | Train Loss: 0.23781 | Val Loss: 0.37021 | Train Acc: 90.417 | Val Acc: 83.000
Epoch 44: | Train Loss: 0.21503 | Val Loss: 0.22583 | Train Acc: 90.833 | Val Acc: 90.333
Epoch 45: | Train Loss: 0.22541 | Val Loss: 0.24615 | Train Acc: 90.278 | Val Acc: 90.125
Epoch 46: | Train Loss: 0.22112 | Val Loss: 0.22262 | Train Acc: 90.778 | Val Acc: 90.875
Epoch 47: | Train Loss: 0.27836 | Val Loss: 0.22114 | Train Acc: 87.472 | Val Acc: 90.833
Epoch 48: | Train Loss: 0.18682 | Val Loss: 0.25671 | Train Acc: 92.556 | Val Acc: 88.292
Epoch 49: | Train Loss: 0.18574 | Val Loss: 0.21996 | Train Acc: 92.472 | Val Acc: 91.167
Epoch 50: | Train Loss: 0.20261 | Val Loss: 0.25496 | Train Acc: 91.917 | Val Acc: 88.292
Finished Training
Traceback (most recent call last):
  File "C:/Users/harry/PycharmProjects/RouteNavigation/MultiLayerPerceptron.py", line 236, in <module>
    print(mlp.get_matched_route_view_idx(grid_view))
  File "C:/Users/harry/PycharmProjects/RouteNavigation/MultiLayerPerceptron.py", line 196, in get_matched_route_view_idx
    x = {i: cos(self.route_view_logits[i], self.model(view_tensor)) for i in range(len(self.route_view_logits))}
AttributeError: 'MultiLayerPerceptron' object has no attribute 'route_view_logits'
